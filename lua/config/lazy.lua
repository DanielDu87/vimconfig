--==============================================================================
-- lazy.nvim æ’ä»¶ç®¡ç†å™¨é…ç½®
--==============================================================================
-- æœ¬æ–‡ä»¶è´Ÿè´£é…ç½® lazy.nvim æ’ä»¶ç®¡ç†å™¨
--
-- lazy.nvim æ˜¯ç°ä»£ Neovim æ’ä»¶ç®¡ç†å™¨ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
-- - å¿«é€Ÿï¼šå¼‚æ­¥åŠ è½½ï¼Œå¯åŠ¨é€Ÿåº¦å¿«
-- - æ˜“ç”¨ï¼šè‡ªåŠ¨ç®¡ç†æ’ä»¶ä¾èµ–ã€æ›´æ–°ã€æ¸…ç†
-- - çµæ´»ï¼šæ”¯æŒæ‡’åŠ è½½ã€æ¡ä»¶åŠ è½½ã€äº‹ä»¶è§¦å‘åŠ è½½
-- - å¯è§†åŒ–ï¼šæä¾› :Lazy å‘½ä»¤æŸ¥çœ‹å’Œç®¡ç†æ’ä»¶

--==============================================================================
-- ç¦ç”¨ LazyVim çš„å¯¼å…¥é¡ºåºä¸¥æ ¼æ£€æŸ¥
-- è¯´æ˜ï¼šæˆ‘ä»¬çš„é…ç½®ç¬¦åˆè§„èŒƒï¼ˆlazyvim.plugins -> extras -> è‡ªå®šä¹‰æ’ä»¶ï¼‰
-- ä½† LazyVim çš„æ£€æŸ¥å™¨æ— æ³•è¯†åˆ«æˆ‘ä»¬ä½¿ç”¨ extras.lua æ–‡ä»¶æ¥ç»„ç»‡ extras
-- å®é™…åŠ è½½é¡ºåºæ˜¯æ­£ç¡®çš„ï¼Œæ‰€ä»¥ç¦ç”¨æ­¤æ£€æŸ¥
vim.g.lazyvim_check_order = false

-- è®¾ç½® lazy.nvim çš„å®‰è£…è·¯å¾„
-- è·¯å¾„ï¼š~/.local/share/nvim/lazy/lazy.nvim
local lazypath = vim.fn.stdpath("data") .. "/lazy/lazy.nvim"

--==============================================================================
-- è‡ªåŠ¨å®‰è£… lazy.nvim
--==============================================================================
-- æ£€æŸ¥ lazy.nvim æ˜¯å¦å·²å®‰è£…ï¼Œå¦‚æœæœªå®‰è£…åˆ™è‡ªåŠ¨å…‹éš†
if not (vim.uv or vim.loop).fs_stat(lazypath) then
	-- lazy.nvim çš„ GitHub ä»“åº“åœ°å€
	local lazyrepo = "https://github.com/folke/lazy.nvim.git"
	-- ä½¿ç”¨ git å…‹éš†ä»“åº“ï¼ˆä½¿ç”¨ --filter=blob:none å‡å°‘ä¸‹è½½å¤§å°ï¼‰
	local out = vim.fn.system({ "git", "clone", "--filter=blob:none", "--branch=stable", lazyrepo, lazypath })
	-- å¦‚æœå…‹éš†å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯å¹¶é€€å‡º
	if vim.v.shell_error ~= 0 then
		vim.api.nvim_echo({
			{ "Failed to clone lazy.nvim:\n", "ErrorMsg" },
			{ out, "WarningMsg" },
			{ "\nPress any key to exit..." },
		}, true, {})
		vim.fn.getchar()
		os.exit(1)
	end
end

--==============================================================================
-- å°† lazy.nvim æ·»åŠ åˆ°è¿è¡Œæ—¶è·¯å¾„çš„æœ€å‰é¢
--==============================================================================
-- è¿™ç¡®ä¿ Neovim ä¼˜å…ˆä½¿ç”¨ lazy.nvimï¼Œè€Œä¸æ˜¯å¯èƒ½å­˜åœ¨çš„å…¶ä»–æ’ä»¶ç®¡ç†å™¨
vim.opt.rtp:prepend(lazypath)

--==============================================================================
-- lazy.nvim é…ç½®
--==============================================================================
require("lazy").setup({
	-- æ’ä»¶è§„èŒƒåˆ—è¡¨
	spec = {
		-- æ·»åŠ  LazyVim æ ¸å¿ƒé…ç½®å¹¶å¯¼å…¥å…¶æ‰€æœ‰æ’ä»¶
		-- LazyVim é¢„é…ç½®äº†å¤§é‡å¸¸ç”¨çš„ Neovim æ’ä»¶
		{ "LazyVim/LazyVim", import = "lazyvim.plugins" },

		-- å¯¼å…¥ä½ çš„è‡ªå®šä¹‰æ’ä»¶é…ç½®ï¼ˆä½äº lua/plugins/ ç›®å½•ï¼‰
		-- åœ¨è¯¥ç›®å½•ä¸­çš„ä»»ä½• .lua æ–‡ä»¶éƒ½ä¼šè¢«è‡ªåŠ¨åŠ è½½
		--
		-- æ³¨æ„ï¼šä¸ºäº†ç¬¦åˆ LazyVim å¯¼å…¥é¡ºåºè§„èŒƒï¼Œæˆ‘ä»¬åœ¨ plugins/ ç›®å½•ä¸­
		-- åˆ›å»ºäº† extras.lua æ–‡ä»¶æ¥é›†ä¸­ç®¡ç†æ‰€æœ‰å®˜æ–¹ extras
		{ import = "plugins" },
	},

	-- UI é…ç½®
	ui = {
		border = "rounded",
		-- è‡ªå®šä¹‰èœå•ç¿»è¯‘
		icons = {
			cmd = "âŒ˜",
			config = "ğŸ› ",
			event = "ğŸ“…",
			ft = "ğŸ“‚",
			init = "âš™",
			import = "î‰½",
			keys = "ğŸ—",
			lazy = "ğŸ’¤ ",
			loaded = "â—",
			not_loaded = "â—‹",
			plugin = "ğŸ“¦",
			runtime = "ğŸ’»",
			source = "ğŸ“„",
			start = "ğŸš€",
			task = "âœ” ",
			list = {
				"â—",
				"âœ",
				"â˜…",
				"â€’",
			},
		},
		-- èœå•æ–‡æœ¬ç¿»è¯‘
		-- æ³¨ï¼šLazy.nvim éƒ¨åˆ†æ–‡æœ¬ç¡¬ç¼–ç åœ¨æºç ä¸­ï¼Œæ— æ³•å®Œå…¨ç¿»è¯‘
		-- è¿™é‡Œåªç¿»è¯‘å¯è‡ªå®šä¹‰çš„éƒ¨åˆ†
		sections = {
			lazy = {
				footer = nil, -- ä¸æ˜¾ç¤ºé¡µè„š
			},
		},
	},

	-- é»˜è®¤é…ç½®
	defaults = {
		-- æ‡’åŠ è½½è®¾ç½®
		-- false: é»˜è®¤æƒ…å†µä¸‹ï¼Œä½ çš„è‡ªå®šä¹‰æ’ä»¶ä¼šåœ¨å¯åŠ¨æ—¶åŠ è½½ï¼ˆLazyVim çš„æ’ä»¶ä»ç„¶æ˜¯æ‡’åŠ è½½çš„ï¼‰
		-- true: å°†æ‰€æœ‰è‡ªå®šä¹‰æ’ä»¶ä¹Ÿè®¾ç½®ä¸ºæ‡’åŠ è½½ï¼ˆéœ€è¦ä½ åœ¨æ’ä»¶é…ç½®ä¸­æ­£ç¡®è®¾ç½®äº‹ä»¶ã€å‘½ä»¤ç­‰ï¼‰
		lazy = false,

		-- ç‰ˆæœ¬ç®¡ç†è®¾ç½®
		-- å»ºè®®ä¿æŒ version=falseï¼Œå› ä¸ºè®¸å¤šæ”¯æŒç‰ˆæœ¬æ§åˆ¶çš„æ’ä»¶çš„å‘å¸ƒç‰ˆæœ¬éƒ½å·²è¿‡æ—¶
		-- è¿™å¯èƒ½å¯¼è‡´ä½ çš„ Neovim å®‰è£…å‡ºç°é—®é¢˜
		version = false, -- å§‹ç»ˆä½¿ç”¨æœ€æ–°çš„ git æäº¤
		-- version = "*", -- å¦‚æœè¦ä½¿ç”¨ç¨³å®šç‰ˆæœ¬ï¼Œå¯ä»¥å–æ¶ˆæ³¨é‡Šè¿™è¡Œï¼ˆä»…é€‚ç”¨äºæ”¯æŒè¯­ä¹‰åŒ–ç‰ˆæœ¬çš„æ’ä»¶ï¼‰
	},

	-- å®‰è£…é…ç½®
	install = {
		-- é¦–æ¬¡å®‰è£…æ—¶å°è¯•è®¾ç½®é…è‰²æ–¹æ¡ˆ
		-- å¦‚æœè¿™äº›é…è‰²æ–¹æ¡ˆæœªå®‰è£…ï¼Œlazy.nvim ä¼šåœ¨å¯åŠ¨å‰è‡ªåŠ¨å®‰è£…å®ƒä»¬
		colorscheme = { "tokyonight", "habamax" },
	},

	-- æ›´æ–°æ£€æŸ¥å™¨é…ç½®
	checker = {
		-- å®šæœŸæ£€æŸ¥æ’ä»¶æ›´æ–°ï¼ˆé»˜è®¤æ¯å‘¨æ£€æŸ¥ä¸€æ¬¡ï¼‰
		enabled = true,
		-- æ£€æŸ¥åˆ°æ›´æ–°æ—¶æ˜¾ç¤ºé€šçŸ¥
		notify = true,
	}, -- automatically check for plugin updates

	-- æ€§èƒ½ä¼˜åŒ–é…ç½®
	performance = {
		-- è¿è¡Œæ—¶è·¯å¾„ï¼ˆrtpï¼‰ä¼˜åŒ–
		rtp = {
			-- ç¦ç”¨ä¸€äº›ä¸éœ€è¦çš„ Neovim å†…ç½®æ’ä»¶
			-- è¿™äº›æ’ä»¶é€šå¸¸ä¸éœ€è¦ï¼Œç¦ç”¨å®ƒä»¬å¯ä»¥æé«˜å¯åŠ¨é€Ÿåº¦
			disabled_plugins = {
				"gzip", -- ç¦ç”¨ gzip å‹ç¼©æ”¯æŒ
				-- "matchit",     -- ä¿æŒå¯ç”¨ï¼ˆæä¾› % å‘½ä»¤çš„å¢å¼ºåŠŸèƒ½ï¼‰
				-- "matchparen",  -- ä¿æŒå¯ç”¨ï¼ˆé«˜äº®åŒ¹é…çš„æ‹¬å·ï¼‰
				"netrwPlugin", -- ç¦ç”¨å†…ç½®æ–‡ä»¶æµè§ˆå™¨ï¼ˆLazyVim ä½¿ç”¨ snacks.explorerï¼‰
				"tarPlugin", -- ç¦ç”¨ tar å½’æ¡£æ–‡ä»¶æ”¯æŒ
				"tohtml", -- ç¦ç”¨è¯­æ³•é«˜äº®å¯¼å‡ºä¸º HTML
				"tutor", -- ç¦ç”¨ Vim æ•™ç¨‹
				"zipPlugin", -- ç¦ç”¨ zip å‹ç¼©æ–‡ä»¶æ”¯æŒ
			},
		},
	},
})
